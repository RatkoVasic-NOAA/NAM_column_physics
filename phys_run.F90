program phys_run
USE MODULE_KINDS
use module_physycs_init,     only : physycs_init
use module_solver_grid_comp, only : solver_run
include 'variables.inc'
integer :: ntimestep
  call physycs_init &
   (START_YEAR,START_MONTH,START_DAY,START_HOUR,START_MINUTE,START_SECOND,MINUTES_HISTORY &
   ,RESTART,gwdflg,CDMB,CLEFF,SIGFAC,factop,rlolev,dpmin,LONGWAVE,SHORTWAVE,CONVECTION &
   ,MICROPHYSICS,TURBULENCE,SFC_LAYER,LAND_SURFACE,CLDFRACTION,RHGRD,SPEC_ADV,UCMCALL &
   ,IVEGSRC,FRES,FR,FSL,FSS,ENTRAIN,NEWALL,NEWSWAP,NEWUPUP,NODEEP,NPHS,NRADS,NRADL,NPRECIP &
   ,sas_pgcon,sas_shal_pgcon,sas_shalconv,sas_mass_flux,sas_mommix,var_ric,coef_ric_l,coef_ric_s &
   ,ALPHA,SFENTH,D_SS,F_QC,F_QR,F_QI,F_QS,F_QG,F_NI,F_NR,MP_RESTART_STATE,TBPVS_STATE,TBPVS0_STATE &
   ,SMC,STC,SH2O,MPRATES,PSGDT,Told,Tadj,F_ICE,F_RAIN,F_RIMEF,refl_10cm,Q2,OMGALF &
   ,O3,Z,CW,Q,T,U,V,RLWTT,RSWTT,EXCH_H,XLEN_MIX,CLDFRA,TRAIN,TCUCN,W_TOT,DUDT,DVDT &
   ,re_cloud,re_ice,re_snow,PINT,NCOUNT,NCFRST,NCFRCV,ISLTYP,IVGTYP,LPBL,ACFRCV,ACFRST &
   ,AKHS,AKHS_OUT,AKMS,AKMS_OUT,ALBASE,ALBEDO,ALBVB,ALBNB,ALBVD,ALBND &
   ,ALWIN,ALWOUT,ALWTOA,ASWIN,ASWOUT,ASWTOA &
   ,BGROFF,CFRACH,CFRACM,CFRACL,CNVBOT,CNVTOP,CMC,CPRATE,CUPPT,CZMEAN,CZEN,EPSR &
   ,FIS,HBOT,HBOTD,HBOTS,HTOP,HTOPD,HTOPS,GRNFLX,MAVAIL,MXSNAL,PBLH,MIXHT,PD,POTEVP &
   ,POTFLX,QSH,QWBS,QZ0,RADOT,RLWIN,RMOL,RSWIN,RSWINC,RSWOUT,RLWTOA,RSWTOA,SFCEVP,SFCEXC &
   ,SFCLHX,SFCSHX,SICE,SIGT4,SM,SMSTAV,SMSTOT,SNO,SNOWC,SNOPCX,SOILTB,SR,SSROFF,SST &
   ,SUBSHX,THS,THZ0,TSKIN,TWBS,USTAR,UZ0,VEGFRC,VZ0,Z0,Z0BASE,STDH,CROT,SROT,HSTDV &
   ,HCNVX,HASYW,HASYS,HASYSW,HASYNW,HLENW,HLENS,HLENSW,HLENNW,HANGL,HANIS,HSLOP,HZMAX &
   ,ACSNOM,ACSNOW,ACPREC,ACPREC_TOT,acpcp_ra,acpcp_sn,acpcp_gr,CUPREC,PREC,CLDEFI,PSHLTR &
   ,PSFC,Q10,QSHLTR,T2,TH10,TSHLTR,U10,V10,TLMIN,TLMAX,ACUTIM,APHTIM &
   ,ARDLW,ARDSW,ASRFC,AVRAIN,AVCNVC,T02MAX,T02MIN,RH02MAX,RH02MIN,SPD10MAX,U10MAX,V10MAX &
   ,UPVVELMAX,DNVVELMAX,T10AVG,T10,PSFCAVG,AKHSAVG,AKMSAVG,SNOAVG,REFDMAX,UPHLMAX,GLAT,GLON &
   ,SI,TG,EPSL,EPSQ2,DSG2,SGML2,PSGML1,PDSG1,SG2,SGM,PSG1,NPREC,NCLOD,NHEAT,NRDLW &
   ,NRDSW,NSRFC,CU_PHYSICS,JULYR,NSTEPS_PER_CHECK,NSTEPS_PER_RESET,IDAT,DT,PT)
!
      open(8,file='BoCo.data',form='unformatted')
      DO NTIMESTEP=0,959
      read(8)t,u,v,q,cw,o3,pint,pd,idat
  call solver_run &
   (START_YEAR,START_MONTH,START_DAY,START_HOUR,START_MINUTE,START_SECOND,MINUTES_HISTORY &
   ,RESTART,gwdflg,CDMB,CLEFF,SIGFAC,factop,rlolev,dpmin,LONGWAVE,SHORTWAVE,CONVECTION &
   ,MICROPHYSICS,TURBULENCE,SFC_LAYER,LAND_SURFACE,CLDFRACTION,RHGRD,SPEC_ADV,UCMCALL &
   ,IVEGSRC,FRES,FR,FSL,FSS,ENTRAIN,NEWALL,NEWSWAP,NEWUPUP,NODEEP,NPHS,NRADS,NRADL,NPRECIP &
   ,sas_pgcon,sas_shal_pgcon,sas_shalconv,sas_mass_flux,sas_mommix,var_ric,coef_ric_l,coef_ric_s &
   ,ALPHA,SFENTH,D_SS,F_QC,F_QR,F_QI,F_QS,F_QG,F_NI,F_NR,MP_RESTART_STATE,TBPVS_STATE,TBPVS0_STATE &
   ,SMC,STC,SH2O,MPRATES,PSGDT,Told,Tadj,F_ICE,F_RAIN,F_RIMEF,refl_10cm,Q2,OMGALF &
   ,O3,Z,CW,Q,T,U,V,RLWTT,RSWTT,EXCH_H,XLEN_MIX,CLDFRA,TRAIN,TCUCN,W_TOT,DUDT,DVDT &
   ,re_cloud,re_ice,re_snow,PINT,NCOUNT,NCFRST,NCFRCV,ISLTYP,IVGTYP,LPBL,ACFRCV,ACFRST &
   ,AKHS,AKHS_OUT,AKMS,AKMS_OUT,ALBASE,ALBEDO,ALBVB,ALBNB,ALBVD,ALBND &
   ,ALWIN,ALWOUT,ALWTOA,ASWIN,ASWOUT,ASWTOA &
   ,BGROFF,CFRACH,CFRACM,CFRACL,CNVBOT,CNVTOP,CMC,CPRATE,CUPPT,CZMEAN,CZEN,EPSR &
   ,FIS,HBOT,HBOTD,HBOTS,HTOP,HTOPD,HTOPS,GRNFLX,MAVAIL,MXSNAL,PBLH,MIXHT,PD,POTEVP &
   ,POTFLX,QSH,QWBS,QZ0,RADOT,RLWIN,RMOL,RSWIN,RSWINC,RSWOUT,RLWTOA,RSWTOA,SFCEVP,SFCEXC &
   ,SFCLHX,SFCSHX,SICE,SIGT4,SM,SMSTAV,SMSTOT,SNO,SNOWC,SNOPCX,SOILTB,SR,SSROFF,SST &
   ,SUBSHX,THS,THZ0,TSKIN,TWBS,USTAR,UZ0,VEGFRC,VZ0,Z0,Z0BASE,STDH,CROT,SROT,HSTDV &
   ,HCNVX,HASYW,HASYS,HASYSW,HASYNW,HLENW,HLENS,HLENSW,HLENNW,HANGL,HANIS,HSLOP,HZMAX &
   ,ACSNOM,ACSNOW,ACPREC,ACPREC_TOT,acpcp_ra,acpcp_sn,acpcp_gr,CUPREC,PREC,CLDEFI,PSHLTR &
   ,PSFC,Q10,QSHLTR,T2,TH10,TSHLTR,U10,V10,TLMIN,TLMAX,ACUTIM,APHTIM &
   ,ARDLW,ARDSW,ASRFC,AVRAIN,AVCNVC,T02MAX,T02MIN,RH02MAX,RH02MIN,SPD10MAX,U10MAX,V10MAX &
   ,UPVVELMAX,DNVVELMAX,T10AVG,T10,PSFCAVG,AKHSAVG,AKMSAVG,SNOAVG,REFDMAX,UPHLMAX,GLAT,GLON &
   ,SI,TG,EPSL,EPSQ2,DSG2,SGML2,PSGML1,PDSG1,SG2,SGM,PSG1,NPREC,NCLOD,NHEAT,NRDLW &
   ,NRDSW,NSRFC,CU_PHYSICS,JULYR,NSTEPS_PER_CHECK,NSTEPS_PER_RESET,IDAT,DT,PT,NTIMESTEP)
      ENDDO ! NTIMESTEP
end program phys_run
